
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2. Statistics &#8212; Coding for Economists</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://aeturrell.github.io/coding-for-economists/statistics.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Coming from Stata" href="coming-from-stata.html" />
    <link rel="prev" title="1. Probability and Random Processes" href="probability-random.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://aeturrell.github.io/coding-for-economists/statistics.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Statistics" />
<meta property="og:description" content="Statistics  Introduction  In this chapter, youâ€™ll learn about how to do statistics with code. We already saw some statistics in the chapter on probability and r" />
<meta property="og:image"       content="https://aeturrell.github.io/coding-for-economists/_static/smith_lovelace.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/smith_lovelace.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Coding for Economists</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Basics
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="preliminaries.html">
   1. Preliminaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="basics-of-coding.html">
   2. Basics of Coding
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="data-analysis-quickstart.html">
   1. Data Analysis Quickstart
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="introduction-to-data-analysis.html">
   2. Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reading-and-writing.html">
   3. Reading and Writing Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-extraction.html">
   4. Extracting Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-advanced.html">
   5. Advanced Data
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Data Visualisation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="data-vis.html">
   1. Intro to Data Visualisation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="common-plots.html">
   2. Common Plots
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Best practice
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="best-practice-coding.html">
   1. Best Practice in Coding
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Mathematics with Code
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="mathematical-coding.html">
   Intro to Mathematics with Code
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Econometrics
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="probability-random.html">
   1. Probability and Random Processes
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2. Statistics
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Coming from ...
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="coming-from-stata.html">
   Coming from Stata
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coming-from-matlab.html">
   Coming from Matlab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coming-from-r.html">
   Coming from R
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Elsewhere
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   Bibliography
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/statistics.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fstatistics.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/statistics.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/docs/statistics.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   2.1. Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notation-and-basic-definitions">
     2.1.1. Notation and basic definitions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imports">
     2.1.2. Imports
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-statistics">
   2.2. Basic statistics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#one-sample-t-test">
   2.3. One-sample t-test
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-to-linear-regression">
     2.3.1. Connection to linear regression
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-information-provided-by-pingouin-tests">
     2.3.2. Other information provided by
     <strong>
      Pingouin
     </strong>
     tests
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-sample-t-test">
   2.4. Two-sample t-test
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pearson-correlation">
   2.5. Pearson correlation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#welch-s-t-test">
   2.6. Welchâ€™s t-test
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#one-way-anova">
   2.7. One-way ANOVA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-pairwise-t-tests">
   2.8. Multiple pairwise t-tests
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#one-way-ancova">
   2.9. One-way ANCOVA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#shapiro-wilk-test-for-normality">
   2.10. Shapiro-Wilk Test for Normality
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#review">
   2.11. Review
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="statistics">
<h1><span class="section-number">2. </span>Statistics<a class="headerlink" href="#statistics" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="introduction">
<h2><span class="section-number">2.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">Â¶</a></h2>
<p>In this chapter, youâ€™ll learn about how to do statistics with code. We already saw some statistics in the chapter on probability and random processes: here weâ€™ll focus on computing basic statistics and using statistical tests. Weâ€™ll make use of the excellent <a class="reference external" href="https://pingouin-stats.org/index.html"><em>pingouin</em></a> statistics package and its documentation for many of the examples and methods in this chapter <a class="bibtex reference internal" href="zreferences.html#vallat2018pingouin" id="id1">[4]</a>.</p>
<div class="section" id="notation-and-basic-definitions">
<h3><span class="section-number">2.1.1. </span>Notation and basic definitions<a class="headerlink" href="#notation-and-basic-definitions" title="Permalink to this headline">Â¶</a></h3>
<p>Greek letters, like <span class="math notranslate nohighlight">\(\beta\)</span>, are the truth and represent parameters. Modified Greek letters are an estimate of the truth, for example <span class="math notranslate nohighlight">\(\hat{\beta}\)</span>. Sometimes Greek letters will stand in for vectors of parameters. Letters from the Latin alphabet denote the values of data, for instance <span class="math notranslate nohighlight">\(x\)</span> for a variable or vector. Modified Latin alphabet letters denote computations performed on data, for instance <span class="math notranslate nohighlight">\(\bar{x} = \frac{1}{n} \displaystyle\sum_{i} x_i\)</span> where <span class="math notranslate nohighlight">\(n\)</span> is number of samples. Parameters are given following a vertical bar, for example if <span class="math notranslate nohighlight">\(f(x|\mu, \sigma)\)</span> is a probability density function, the vertical line indicates that its parameters are <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span>. The set of distributions with densities <span class="math notranslate nohighlight">\(f_\theta(x)\)</span>, <span class="math notranslate nohighlight">\(\theta \in \Theta\)</span> is called a parametric family, eg there is a family of different distributions that are parametrised by <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<p>A <strong>statistic</strong> <span class="math notranslate nohighlight">\(T(x)\)</span> is a function of the data <span class="math notranslate nohighlight">\(x=(x_1, \dots, x_n)\)</span>.</p>
<p>An <strong>estimator</strong> of a parameter <span class="math notranslate nohighlight">\(\theta\)</span> is a function <span class="math notranslate nohighlight">\(T=T(x)\)</span> which is used to estimate <span class="math notranslate nohighlight">\(\theta\)</span> based on observations of data. <span class="math notranslate nohighlight">\(T\)</span> is an unbiased estimator if <span class="math notranslate nohighlight">\(\mathbb{E}(T) = \theta\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(X\)</span> has PDF <span class="math notranslate nohighlight">\(f(x|\theta)\)</span> then, given the observed value <span class="math notranslate nohighlight">\(x\)</span> of <span class="math notranslate nohighlight">\(X\)</span>, the <strong>likelihood</strong> of <span class="math notranslate nohighlight">\(\theta\)</span> is defined by <span class="math notranslate nohighlight">\(\text{lik}(\theta) = f(x | \theta)\)</span>. For independent and identically distributed observed values, then <span class="math notranslate nohighlight">\(\text{lik}(\theta) = f(x_1, \dots, x_n| \theta) = \Pi_{i=1}^n f(x_i | \theta)\)</span>. The <span class="math notranslate nohighlight">\(\hat{\theta}\)</span> such that this function attains its maximum value is the <strong>maximum likelihood estimator (MLE)</strong> of <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<p>Given an MLE <span class="math notranslate nohighlight">\(\hat{\theta}\)</span> of <span class="math notranslate nohighlight">\(\theta\)</span>, <span class="math notranslate nohighlight">\(\hat{\theta}\)</span> is said to be <strong>consistent</strong> if <span class="math notranslate nohighlight">\(\mathbb{P}(\hat{\theta} - \theta &gt; \epsilon) \rightarrow 0\)</span> as <span class="math notranslate nohighlight">\(n\rightarrow \infty\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(\gamma(X)\)</span> and <span class="math notranslate nohighlight">\(\delta(X)\)</span> be two statistics satisfying <span class="math notranslate nohighlight">\(\gamma(X) &lt; \delta(X)\)</span> for all <span class="math notranslate nohighlight">\(X\)</span>. If on observing <span class="math notranslate nohighlight">\(X = x\)</span>, the inference can be made that <span class="math notranslate nohighlight">\(\gamma(x) \leq \theta \leq \delta(x)\)</span>. Then <span class="math notranslate nohighlight">\([\delta(x), \gamma(x)]\)</span> is an <strong>interval estimate</strong> and <span class="math notranslate nohighlight">\([\delta(X), \gamma(X)]\)</span> is an <strong>interval estimator</strong>. The random interval (random because the <em>endpoints</em> are random variables) <span class="math notranslate nohighlight">\([\delta(X), \gamma(X)]\)</span> is called a <span class="math notranslate nohighlight">\(100\cdot\alpha \%\)</span> <strong>confidence interval</strong> for <span class="math notranslate nohighlight">\(\theta\)</span>. Of course, there is a true <span class="math notranslate nohighlight">\(\theta\)</span>, so either it is in this interval or it is not. But if the confidence interval was constructed many times over using samples, then it would contain <span class="math notranslate nohighlight">\(\theta\)</span> <span class="math notranslate nohighlight">\(100\cdot\alpha \%\)</span> of the times.</p>
<p>A <strong>hypothesis test</strong> is a conjecture about the distribution of one or more random variables, and a test of a hypothesis is a procedure for deciding whether to reject that conjecture. The <strong>null hypothesis</strong> is <span class="math notranslate nohighlight">\(H_0\)</span> is only conservatively rejected; in that case the <strong>alternative hypothesis</strong>, <span class="math notranslate nohighlight">\(H_1\)</span>, is accepted. If <span class="math notranslate nohighlight">\(H_0\)</span> is rejected when it is true, then it is a type I error (arguably more serioues given the test favours <span class="math notranslate nohighlight">\(H_0\)</span>); if <span class="math notranslate nohighlight">\(H_1\)</span> is accepted when it is false, it is a type II error. In the most simple situations, the upper bound on the probability of a type I error is called the size or <strong>significance level</strong> of the <em>test</em>. The <strong>p-value</strong> of a random variable <span class="math notranslate nohighlight">\(x\)</span> is the smallest value of the significance level (often denoted <span class="math notranslate nohighlight">\(\alpha\)</span>) for which <span class="math notranslate nohighlight">\(H_0\)</span> would be rejected on the basis of seeing <span class="math notranslate nohighlight">\(x\)</span>. The p-value is sometimes called the significance level of <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Recall that there are two types of statistics out there: parametrised, eg by <span class="math notranslate nohighlight">\(\theta\)</span>, and non-parametrised. The latter are often distribution free (ie donâ€™t involve a PDF) or donâ€™t require parameters to be specified.</p>
</div>
<div class="section" id="imports">
<h3><span class="section-number">2.1.2. </span>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">Â¶</a></h3>
<p>First we need to import the packages weâ€™ll be using</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pingouin</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">PCG64</span>

<span class="c1"># Set seed for random numbers</span>
<span class="n">seed_for_prng</span> <span class="o">=</span> <span class="mi">78557</span>
<span class="n">prng</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="n">PCG64</span><span class="p">(</span><span class="n">seed_for_prng</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="basic-statistics">
<h2><span class="section-number">2.2. </span>Basic statistics<a class="headerlink" href="#basic-statistics" title="Permalink to this headline">Â¶</a></h2>
<p>Letâ€™s start with computing the simplest statistics you can think of using some synthetic data. Many of the functions have lots of extra options that we wonâ€™t explore here (like weights or normalisation); remember that you can see these using the <code class="docutils literal notranslate"><span class="pre">help()</span></code> method.</p>
<p>Weâ€™ll generate a vector with 100 entries:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
       34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,
       51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67,
       68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84,
       85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99])
</pre></div>
</div>
</div>
</div>
<p>Okay, letâ€™s see how some basic statistics are computed. The mean is <code class="docutils literal notranslate"><span class="pre">np.mean(data)=</span></code><span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">'49.5'</span></code></span>, the standard deviation is <code class="docutils literal notranslate"><span class="pre">np.std(data)=</span></code><span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">'28.9'</span></code></span>, and the median is given by <code class="docutils literal notranslate"><span class="pre">np.median(data)=</span></code><span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">'49.5'</span></code></span>. The mode is given by <code class="docutils literal notranslate"><span class="pre">stats.mode([0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">5])[0]=</span></code><span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">'3.0'</span></code></span> (access the counts using <code class="docutils literal notranslate"><span class="pre">stats.mode(...)[1]</span></code>).</p>
<p>Less famous quantiles than the median are given by, for example for <span class="math notranslate nohighlight">\(q=0.25\)</span>,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>24.75
</pre></div>
</div>
</div>
</div>
<p>As with <strong>pandas</strong>, <strong>numpy</strong> and <strong>scipy</strong> work on scalars, vectors, matrices, and tensors: you just need to specify the axis that youâ€™d like to apply a function to:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfunction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0, 1, 2, 3, 4, 5],
       [1, 2, 3, 4, 5, 6],
       [2, 3, 4, 5, 6, 7]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1., 2., 3., 4., 5., 6.])
</pre></div>
</div>
</div>
</div>
<p>Remember that, for discrete data points, the <span class="math notranslate nohighlight">\(k\)</span>th (unnormalised) moment is</p>
<div class="math notranslate nohighlight">
\[
\hat{m}_k = \frac{1}{n}\displaystyle\sum_{i=1}^{n} \left(x_i - \bar{x}\right)^k
\]</div>
<p>To compute this use scipyâ€™s <code class="docutils literal notranslate"><span class="pre">stats.moment(a,</span> <span class="pre">moment=1)</span></code>. For instance for the kurtosis (<span class="math notranslate nohighlight">\(k=4\)</span>), itâ€™s</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">moment</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">moment</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([14.72916667, 14.72916667, 14.72916667])
</pre></div>
</div>
</div>
</div>
<p>Covariances are found using <code class="docutils literal notranslate"><span class="pre">np.cov</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1., -1.],
       [-1.,  1.]])
</pre></div>
</div>
</div>
</div>
<p>Note that, as expected, the <span class="math notranslate nohighlight">\(C_{01}\)</span> term is -1 as the vectors are anti-correlated.</p>
</div>
<div class="section" id="one-sample-t-test">
<h2><span class="section-number">2.3. </span>One-sample t-test<a class="headerlink" href="#one-sample-t-test" title="Permalink to this headline">Â¶</a></h2>
<p>The one-sample t-test tells us whether a given parameter for the mean, i.e. a suspected <span class="math notranslate nohighlight">\(\mu\)</span>, is likely to be consistent with the sample mean. The null hypothesis is that <span class="math notranslate nohighlight">\(\mu = \bar{x}\)</span>. Letâ€™s see an example using the default <code class="docutils literal notranslate"><span class="pre">tail='two-sided'</span></code> option. Imagine we have data on the number of hours people spend working each day and we want to test the (alternative) hypothesis that <span class="math notranslate nohighlight">\(\bar{x}\)</span> is not <span class="math notranslate nohighlight">\(\mu=\)</span>8 hours:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">8.5</span><span class="p">,</span> <span class="mf">5.4</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">,</span> <span class="mf">9.6</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">7.2</span><span class="p">,</span> <span class="mf">8.8</span><span class="p">,</span> <span class="mf">8.1</span><span class="p">]</span>

<span class="n">pg</span><span class="o">.</span><span class="n">ttest</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>tail</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>-1.05</td>
      <td>7</td>
      <td>two-sided</td>
      <td>0.33</td>
      <td>[5.81, 8.84]</td>
      <td>0.37</td>
      <td>0.52</td>
      <td>0.15</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>(The returned object is a <strong>pandas</strong> dataframe.) We only have 8 data points, and so that is a great big confidence interval! Itâ€™s worth remembering what a t-statistic and t-test really are. In this case, the statistic that is constructed to test whether the sample mean is different from a known parameter <span class="math notranslate nohighlight">\(\mu\)</span> is</p>
<div class="math notranslate nohighlight">
\[
T = \frac{\sqrt{n}(\bar{x}-\mu)}{\hat{\sigma}} \thicksim t_{n-1}
\]</div>
<p>where <span class="math notranslate nohighlight">\(t_{n-1}\)</span> is the studentâ€™s t-distribution and <span class="math notranslate nohighlight">\(n-1\)</span> is the number of degrees of freedom. The <span class="math notranslate nohighlight">\(100\cdot(1-\alpha)\%\)</span> test interval in this case is given by</p>
<div class="math notranslate nohighlight">
\[
1 - \alpha = \mathbb{P}\left(-t_{n-1, \alpha/2} \leq \frac{\sqrt{n}(\bar{x} - \mu)}{\hat{\sigma}} \leq t_{n-1,\alpha/2}\right)
\]</div>
<p>where we define <span class="math notranslate nohighlight">\(t_{n-1, \alpha/2}\)</span> such that <span class="math notranslate nohighlight">\(\mathbb{P}(T &gt; t_{n-1, \alpha/2}) = \alpha/2\)</span>. For <span class="math notranslate nohighlight">\(\alpha=0.05\)</span>, implying confidence intervals of 95%, this looks like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">st</span>

<span class="k">def</span> <span class="nf">plot_t_stat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
    <span class="n">pdf_vals</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">sigma_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">actual_T_stat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span><span class="p">))</span><span class="o">/</span><span class="n">sigma_hat</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
    <span class="n">T_alpha_over_2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">interval_T</span> <span class="o">=</span> <span class="n">T</span><span class="p">[((</span><span class="n">T</span><span class="o">&gt;-</span><span class="n">T_alpha_over_2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">T</span><span class="o">&lt;</span><span class="n">T_alpha_over_2</span><span class="p">))]</span>
    <span class="n">interval_y</span> <span class="o">=</span> <span class="n">pdf_vals</span><span class="p">[((</span><span class="n">T</span><span class="o">&gt;-</span><span class="n">T_alpha_over_2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">T</span><span class="o">&lt;</span><span class="n">T_alpha_over_2</span><span class="p">))]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">pdf_vals</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Student t: dof=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">interval_T</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">interval_y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;95</span><span class="si">% i</span><span class="s1">nterval&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">actual_T_stat</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">actual_T_stat</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\sqrt</span><span class="si">{n}</span><span class="s1">(\bar</span><span class="si">{x}</span><span class="s1"> - \mu)/\hat{\sigma}}$&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orchid&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">actual_T_stat</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">actual_T_stat</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orchid&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Value of statistic T&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PDF&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">plot_t_stat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/statistics_19_0.png" src="_images/statistics_19_0.png" />
</div>
</div>
<p>In this case, we would reject the alternative hypothesis. You can see why from the plot; the test statistic we have constructed lies within the interval where we cannot reject the null hypothesis. <span class="math notranslate nohighlight">\(\bar{x}-\mu\)</span> is close enough to zero to give us cause for concern. (You can also see from the plot why this is a two-tailed test: we donâ€™t care if <span class="math notranslate nohighlight">\(\bar{x}\)</span> is greater or less than <span class="math notranslate nohighlight">\(\mu\)</span>, just that itâ€™s differentâ€“and so the test statistic could appear in either tail of the distribution for us to accept <span class="math notranslate nohighlight">\(H_1\)</span>.)</p>
<p>We accept the null here, but about if there were many more data points? Letâ€™s try adding some generated data (pretend it is from making extra observations).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;Observe&#39; extra data</span>
<span class="n">extra_data</span> <span class="o">=</span> <span class="n">prng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="c1"># Add it in to existing vector</span>
<span class="n">x_prime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">extra_data</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="c1"># Run t-test</span>
<span class="n">pg</span><span class="o">.</span><span class="n">ttest</span><span class="p">(</span><span class="n">x_prime</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>tail</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>-4.87</td>
      <td>37</td>
      <td>two-sided</td>
      <td>0.0</td>
      <td>[6.69, 7.46]</td>
      <td>0.79</td>
      <td>1035.6</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Okay, what happened? Our extra observations have seen the confidence interval shrink considerably, and the p-value is effectively 0. Thereâ€™s a large negative t-statistic too. Unsurprisingly, as we chose a uniform distribution that only just included 8 but was centered on <span class="math notranslate nohighlight">\((8-4.5)/2\)</span> <em>and</em> we had more points, the test now rejects the null hypothesis that <span class="math notranslate nohighlight">\(\mu=8\)</span> . Because the alternative hypothesis is just <span class="math notranslate nohighlight">\(\mu\neq8\)</span>, and these tests are conservative, we havenâ€™t got an estimate of what the mean actually is; we just know that our test rejects that itâ€™s <span class="math notranslate nohighlight">\(8\)</span>.</p>
<p>We can see this in a new version of the chart that uses the extra data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_t_stat</span><span class="p">(</span><span class="n">x_prime</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/statistics_23_0.png" src="_images/statistics_23_0.png" />
</div>
</div>
<p>Now our test statistic is safely outside the interval.</p>
<div class="section" id="connection-to-linear-regression">
<h3><span class="section-number">2.3.1. </span>Connection to linear regression<a class="headerlink" href="#connection-to-linear-regression" title="Permalink to this headline">Â¶</a></h3>
<p>Note that testing if <span class="math notranslate nohighlight">\(\mu\neq0\)</span> is equivalent to having the alternative hypothesis that a single, non-zero scalar value is a good expected value for <span class="math notranslate nohighlight">\(x\)</span>, i.e. that <span class="math notranslate nohighlight">\(\mathbb{E}(x) \neq 0\)</span>. Which may sound familiar if youâ€™ve run <strong>linear regression</strong> and, indeed, this t-test has an equivalent linear model! Itâ€™s just regressing <span class="math notranslate nohighlight">\(X\)</span> on a constantâ€“a single, non-zero scalar value. In general, t-tests appear in linear regression to test whether any coefficient <span class="math notranslate nohighlight">\(\beta \neq 0\)</span>.</p>
<p>We can see this connection by running a hypothesis test of whether the sample mean is not zero. Note the confidence interval, t-statistic, and p-value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pg</span><span class="o">.</span><span class="n">ttest</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>tail</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>11.406</td>
      <td>7</td>
      <td>two-sided</td>
      <td>0.0</td>
      <td>[5.81, 8.84]</td>
      <td>4.033</td>
      <td>2070.596</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And, as an alternative, regressing x on a constant, again noting the interval, t-stat, and p-value:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;x ~ 1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="c1"># Show only the info relevant to the intercept (there are no other coefficients)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      7.3250      0.642     11.406      0.000       5.806       8.844
==============================================================================
</pre></div>
</div>
</div>
</div>
<p>Many tests have an equivalent  linear model.</p>
</div>
<div class="section" id="other-information-provided-by-pingouin-tests">
<h3><span class="section-number">2.3.2. </span>Other information provided by <strong>Pingouin</strong> tests<a class="headerlink" href="#other-information-provided-by-pingouin-tests" title="Permalink to this headline">Â¶</a></h3>
<p>Weâ€™ve covered the degrees of freedom, the T statistic, the p-value, and the confidence interval. So whatâ€™s all that other gunk in our t-test? Cohenâ€™s d is a measure of whether the difference being measured in our test is large or not (this is important; you can have statistically significant differences that are so small as to be inconsequential). Cohen suggested that <span class="math notranslate nohighlight">\(d = 0.2\)</span> be considered a â€˜smallâ€™ effect size, 0.5 represents a â€˜mediumâ€™ effect size and 0.8 a â€˜largeâ€™ effect size. BF10 represents the Bayes factor, the ratio (given the data) of the likelihood of the alternative hypothesis relative to the null hypothesis. Values greater than unity therefore favour the alternative hypothesis. Finally, power is the achieved power of the test, which is <span class="math notranslate nohighlight">\(1 - \mathbb{P}(\text{type II error})\)</span>. A common default to have in mind is a power greater than 0.8.</p>
</div>
</div>
<div class="section" id="two-sample-t-test">
<h2><span class="section-number">2.4. </span>Two-sample t-test<a class="headerlink" href="#two-sample-t-test" title="Permalink to this headline">Â¶</a></h2>
<p>The two-sample t-test is used to determine if two population means are equal (with the null being that they <em>are</em> equal). Letâ€™s look at an example with synthetic data of equal length, which means we can use the <em>paired</em> version of this. Weâ€™ll imagine we are looking at an intervention with a pre- and post- dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pre</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">,</span> <span class="mf">9.6</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.9</span><span class="p">]</span>
<span class="n">post</span> <span class="o">=</span> <span class="p">[</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mf">6.4</span><span class="p">,</span> <span class="mf">11.</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">,</span> <span class="mf">6.2</span><span class="p">]</span>
<span class="n">pg</span><span class="o">.</span><span class="n">ttest</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">paired</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>tail</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>-2.47</td>
      <td>5</td>
      <td>two-sided</td>
      <td>0.06</td>
      <td>[-1.29, 0.03]</td>
      <td>0.25</td>
      <td>1.91</td>
      <td>0.08</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In this case, we cannot reject the null hypothesis that the means are the same pre- and post-intervention.</p>
</div>
<div class="section" id="pearson-correlation">
<h2><span class="section-number">2.5. </span>Pearson correlation<a class="headerlink" href="#pearson-correlation" title="Permalink to this headline">Â¶</a></h2>
<p>The Pearson correlation coefficient measures the linear relationship between two datasets. Strictly speaking, it requires that each dataset be normally distributed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="p">,</span> <span class="n">cov</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">prng</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="c1"># Compute Pearson correlation</span>
<span class="n">pg</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n</th>
      <th>r</th>
      <th>CI95%</th>
      <th>r2</th>
      <th>adj_r2</th>
      <th>p-val</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pearson</th>
      <td>30</td>
      <td>0.461</td>
      <td>[0.12, 0.7]</td>
      <td>0.212</td>
      <td>0.154</td>
      <td>0.01</td>
      <td>5.198</td>
      <td>0.747</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="welch-s-t-test">
<h2><span class="section-number">2.6. </span>Welchâ€™s t-test<a class="headerlink" href="#welch-s-t-test" title="Permalink to this headline">Â¶</a></h2>
<p>In the case where you have two samples with unequal variances (or, really, unequal sample sizes too), Welchâ€™s t-test is appropriate. With <code class="docutils literal notranslate"><span class="pre">correction='true'</span></code>, it assumes that variances are not equal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">prng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">prng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">pg</span><span class="o">.</span><span class="n">ttest</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">correction</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>tail</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>1.97091</td>
      <td>33</td>
      <td>two-sided</td>
      <td>0.057169</td>
      <td>[-0.02, 1.17]</td>
      <td>0.673194</td>
      <td>1.416</td>
      <td>0.4815</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="one-way-anova">
<h2><span class="section-number">2.7. </span>One-way ANOVA<a class="headerlink" href="#one-way-anova" title="Permalink to this headline">Â¶</a></h2>
<p>Analysis of variance (ANOVA) is a technique for testing hypotheses about means, for example testing the equality of the means of <span class="math notranslate nohighlight">\(k&gt;2\)</span> groups. The model would be</p>
<div class="math notranslate nohighlight">
\[
X_{ij} = \mu_i + \epsilon_{ij} \quad j=1, \dots, n_i \quad i=1, \dots, k.
\]</div>
<p>so that the <span class="math notranslate nohighlight">\(i\)</span>th group has <span class="math notranslate nohighlight">\(n_i\)</span> observations. The null hypothesis of one-way ANOVA is that <span class="math notranslate nohighlight">\(H_0: \mu_1 = \mu_2 = \dots = \mu_k\)</span>, with the alternative hypothesis that this is <em>not</em> true.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">read_dataset</span><span class="p">(</span><span class="s1">&#39;mixed_anova&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Scores</th>
      <th>Time</th>
      <th>Group</th>
      <th>Subject</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.971435</td>
      <td>August</td>
      <td>Control</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.309024</td>
      <td>August</td>
      <td>Control</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6.932707</td>
      <td>August</td>
      <td>Control</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.187348</td>
      <td>August</td>
      <td>Control</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.779411</td>
      <td>August</td>
      <td>Control</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the ANOVA</span>
<span class="n">pg</span><span class="o">.</span><span class="n">anova</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">dv</span><span class="o">=</span><span class="s1">&#39;Scores&#39;</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="s1">&#39;Group&#39;</span><span class="p">,</span> <span class="n">detailed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source</th>
      <th>SS</th>
      <th>DF</th>
      <th>MS</th>
      <th>F</th>
      <th>p-unc</th>
      <th>np2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Group</td>
      <td>5.459963</td>
      <td>1</td>
      <td>5.459963</td>
      <td>5.243656</td>
      <td>0.0232</td>
      <td>0.028616</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Within</td>
      <td>185.342729</td>
      <td>178</td>
      <td>1.041251</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="multiple-pairwise-t-tests">
<h2><span class="section-number">2.8. </span>Multiple pairwise t-tests<a class="headerlink" href="#multiple-pairwise-t-tests" title="Permalink to this headline">Â¶</a></h2>
<p>Thereâ€™s a problem with running multiple t-tests: if you run enough of them, something is bound to come up as significant! As such, some <em>post-hoc</em> adjustments exist that correct for the fact that multiple tests are occurring simultaneously. In the example below, multiple pairwise comparisons are made between the scores by time group. There is a corrected p-value, <code class="docutils literal notranslate"><span class="pre">p-corr</span></code>, computed using the Benjamini/Hochberg FDR correction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pg</span><span class="o">.</span><span class="n">pairwise_ttests</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">dv</span><span class="o">=</span><span class="s1">&#39;Scores&#39;</span><span class="p">,</span> <span class="n">within</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">subject</span><span class="o">=</span><span class="s1">&#39;Subject&#39;</span><span class="p">,</span>
                   <span class="n">parametric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">padjust</span><span class="o">=</span><span class="s1">&#39;fdr_bh&#39;</span><span class="p">,</span> <span class="n">effsize</span><span class="o">=</span><span class="s1">&#39;hedges&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Contrast</th>
      <th>A</th>
      <th>B</th>
      <th>Paired</th>
      <th>Parametric</th>
      <th>T</th>
      <th>dof</th>
      <th>Tail</th>
      <th>p-unc</th>
      <th>p-corr</th>
      <th>p-adjust</th>
      <th>BF10</th>
      <th>hedges</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Time</td>
      <td>August</td>
      <td>January</td>
      <td>True</td>
      <td>True</td>
      <td>-1.740</td>
      <td>59.0</td>
      <td>two-sided</td>
      <td>0.087</td>
      <td>0.131</td>
      <td>fdr_bh</td>
      <td>0.582</td>
      <td>-0.328</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Time</td>
      <td>August</td>
      <td>June</td>
      <td>True</td>
      <td>True</td>
      <td>-2.743</td>
      <td>59.0</td>
      <td>two-sided</td>
      <td>0.008</td>
      <td>0.024</td>
      <td>fdr_bh</td>
      <td>4.232</td>
      <td>-0.483</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Time</td>
      <td>January</td>
      <td>June</td>
      <td>True</td>
      <td>True</td>
      <td>-1.024</td>
      <td>59.0</td>
      <td>two-sided</td>
      <td>0.310</td>
      <td>0.310</td>
      <td>fdr_bh</td>
      <td>0.232</td>
      <td>-0.170</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="one-way-ancova">
<h2><span class="section-number">2.9. </span>One-way ANCOVA<a class="headerlink" href="#one-way-ancova" title="Permalink to this headline">Â¶</a></h2>
<p>Analysis of covariance (ANCOVA) is a general linear model which blends ANOVA and regression. ANCOVA evaluates whether the means of a dependent variable (dv) are equal across levels of a categorical independent variable (between) often called a treatment, while statistically controlling for the effects of other continuous variables that are not of primary interest, known as covariates or nuisance variables (covar).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">read_dataset</span><span class="p">(</span><span class="s1">&#39;ancova&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Scores</th>
      <th>Income</th>
      <th>BMI</th>
      <th>Method</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12</td>
      <td>17.5</td>
      <td>20</td>
      <td>A</td>
    </tr>
    <tr>
      <th>1</th>
      <td>39</td>
      <td>104.6</td>
      <td>20</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2</th>
      <td>36</td>
      <td>64.7</td>
      <td>24</td>
      <td>A</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17</td>
      <td>47.0</td>
      <td>19</td>
      <td>A</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25</td>
      <td>22.0</td>
      <td>21</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pg</span><span class="o">.</span><span class="n">ancova</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">dv</span><span class="o">=</span><span class="s1">&#39;Scores&#39;</span><span class="p">,</span> <span class="n">covar</span><span class="o">=</span><span class="s1">&#39;Income&#39;</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="s1">&#39;Method&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source</th>
      <th>SS</th>
      <th>DF</th>
      <th>F</th>
      <th>p-unc</th>
      <th>np2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Method</td>
      <td>571.029883</td>
      <td>3</td>
      <td>3.336482</td>
      <td>0.031940</td>
      <td>0.244077</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Income</td>
      <td>1678.352687</td>
      <td>1</td>
      <td>29.419438</td>
      <td>0.000006</td>
      <td>0.486920</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Residual</td>
      <td>1768.522313</td>
      <td>31</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="shapiro-wilk-test-for-normality">
<h2><span class="section-number">2.10. </span>Shapiro-Wilk Test for Normality<a class="headerlink" href="#shapiro-wilk-test-for-normality" title="Permalink to this headline">Â¶</a></h2>
<p>Note that the null here is that the distribution <em>is</em> normal, so normality is only rejected when the p-value is sufficiently small.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">prng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">pg</span><span class="o">.</span><span class="n">normality</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>W</th>
      <th>pval</th>
      <th>normal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.954132</td>
      <td>0.434179</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The test can also be run on multiple variables in a dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pg</span><span class="o">.</span><span class="n">normality</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Scores&#39;</span><span class="p">,</span> <span class="s1">&#39;Income&#39;</span><span class="p">,</span> <span class="s1">&#39;BMI&#39;</span><span class="p">]],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;normaltest&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>W</th>
      <th>pval</th>
      <th>normal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Scores</th>
      <td>3.518</td>
      <td>0.172</td>
      <td>True</td>
    </tr>
    <tr>
      <th>Income</th>
      <td>1.869</td>
      <td>0.393</td>
      <td>True</td>
    </tr>
    <tr>
      <th>BMI</th>
      <td>5.135</td>
      <td>0.077</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="review">
<h2><span class="section-number">2.11. </span>Review<a class="headerlink" href="#review" title="Permalink to this headline">Â¶</a></h2>
<p>In this very short introduction to statistics with code, you should have learned how to:</p>
<ul class="simple">
<li><p>[x]</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "codeforecon"
        },
        kernelOptions: {
            kernelName: "codeforecon",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'codeforecon'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="probability-random.html" title="previous page"><span class="section-number">1. </span>Probability and Random Processes</a>
    <a class='right-next' id="next-link" href="coming-from-stata.html" title="next page">Coming from Stata</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Arthur Turrell<br/>
        
            &copy; Copyright 2020.<br/>
          <div class="extra_footer">
            This book is available under an MIT license.

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-78726233-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>